FROM node:22-slim

ARG EMAIL_USER
ARG APP_PASS
ARG PORT
ARG RABBITMQ_IP
ARG RABBITMQ_PORT
ARG RABBITMQ_USERNAME
ARG RABBITMQ_PASSWORD
ARG MAILS_QUEUE



ENV EMAIL_USER=$EMAIL_USER
ENV APP_PASS=$APP_PASS
ENV PORT=$PORT
ENV RABBITMQ_IP=$RABBITMQ_IP
ENV RABBITMQ_PORT=$RABBITMQ_PORT
ENV RABBITMQ_USERNAME=$RABBITMQ_USERNAME
ENV RABBITMQ_PASSWORD=$RABBITMQ_PASSWORD
ENV MAILS_QUEUE=$MAILS_QUEUE


WORKDIR /app

COPY package*.json ./

RUN npm install

COPY . ./

RUN npm install -g typescript

RUN tsc

EXPOSE 4000

CMD ["npm", "run", "start"]
